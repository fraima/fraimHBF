**Выбор технологии**
============

почему же nftables?
------------

При разработке стоял выбор между тремя технологиями:  
- iptables  
- nftables  
- eBPF

После размышлений выбор пал на nftables. Так почему же nftables?

**TODO**: расписать причину выбора. Указать желание сделать еще и поддержку eBPF.

<s>
Изначально было принято решение использовать технологию [eBPF](https://ebpf.io/what-is-ebpf/), так как она обладает рядом очевидных преимуществ по сравнению с [nftables](https://wiki.nftables.org/wiki-nftables/index.php/What_is_nftables%3F) и [iptables](https://en.wikipedia.org/wiki/Iptables). Однако, учитывая тот факт, что многие крупные компании до сих пор используют устаревшие версии ядра Linux, которые не поддерживают ebpf, мы были вынуждены пересмотреть свое решение в пользу nftables (преимущества описаны ниже).
</s>

<s>
Наша команда всегда учитывает потребности наших клиентов и разрабатывает архитектуру с учетом возможности использования Роя на eBPF. Мы уверены, что в будущем это обеспечит наибольшую эффективность и безопасность работы нашей инфраструктуры для всех наших пользователей.
</s>


**КОММЕНТАРИЙ:  
1. из этих двух обзацев не понятно, что в итоге под копотом nf или eBPF.  
2. *Изначально было принято решение использовать технологию eBPF* - большинство не будет читать дальше этой фразы.   
3. Я бы вообще их выпилил **

## iptables
------------
**TODO:** добавить описание. Добавить ссылку https://en.wikipedia.org/wiki/Iptables / https://linux.die.net/man/8/iptables
???+Плюсы tip
    - Имеет длительную историю использования и широкое распространение.
    - Обладает качественной документацией и обширным набором ресурсов для обучения и отладки.
    - Представляет собой мощный инструмент для управления трафиком с обширным набором настроек и возможностей.
    - Обеспечивается хорошей поддержкой и имеет широкое сообщество пользователей.
    - Совместим с другими инструментами, такими как [fail2ban](https://www.fail2ban.org/wiki/index.php/Main_Page), для обеспечения дополнительной защиты сервера.

???+Минусы danger
    - Обладает сложным и запутанным синтаксисом, что может затруднить работу начинающих пользователей.
    - Не полностью поддерживает декларативную конфигурацию, что усложняет отслеживание и управление правилами.
    - Некоторые функции, такие как обработка фрагментированных пакетов, могут работать медленнее, чем в nftables и eBPF.
    - Имеет ограниченную гибкость по сравнению с более современными решениями, такими как nftables и eBPF.

## nftables
---------
**TODO:** добавить описание. Добавить ссылку https://wiki.nftables.org/wiki-nftables/index.php/What_is_nftables%3F
???+Плюсы tip 
    - Имеет простой и понятный синтаксис.
    - Обеспечивает полностью декларативный подход к конфигурации брандмауэра.
    - Обрабатывает фрагменты пакетов быстрее, чем iptables.
    - Поддерживает широкий спектр функций. **TODO:** ссылку на список функций.
    - Позволяет динамически (в реальном времени) обновлять правила без перезагрузки или перекомпиляции ядра.
    - Обладает возможностью группировки правил. <s>для более эффективного управления правилами, связанными с различными группами пакетов</s>.
    - Обладает поддержкой более сложных типов соответствий, что делает настройку более гибкой. <s>которые могут использоваться для определения конкретных условий, таких как наличие определенных флагов TCP или значений IP-адресов.</s>
    - Поддерживает нативный синтаксис для работы с IP-адресами и другими типами данных, что упрощает конфигурацию брандмауэра.
    - Позволяет отслеживать состояние соединений, что позволяет создавать более сложные правила, основанные на состоянии соединения.
???+Минусы danger
    - Относительно новый инструмент, поэтому у него меньше сообщество пользователей и ресурсов для обучения и отладки, чем у iptables.
    - Некоторые функции, такие как поддержка определенных модулей ядра, могут быть ограничены.
    - Не все возможности, доступные в iptables, доступны в nftables.

## eBPF
---------
**TODO:** добавить описание. Добавить ссылку https://ebpf.io/what-is-ebpf/
???+Плюсы tip
    - Высокая производительность и гибкость достигаются за счет использования JIT-компиляции и возможности динамической загрузки и отключения программ. Это особенно важно в условиях высокой нагрузки и сложной сетевой инфраструктуры.
    - Широкий набор инструментов для анализа сетевых пакетов.<s> и принятия решений на основе различных метрик позволяет эффективно контролировать сетевой трафик.</s>

???+Минусы danger
    - Ограничения в возможностях: ebpf не поддерживает некоторые функции, которые могут быть полезны в качестве брандмауэра, например, отслеживание состояния соединения.
    - Сложность настройки: использование ebpf требует определенного уровня знаний, что может сделать его настройку и использование более сложным для неопытных пользователей. Учитывайте это при выборе инструмента для обеспечения безопасности вашей сетевой инфраструктуры.
    - **TODO:** работает на версиях ядра Linux выше 4.14


